<div class="dashboard-layout">
  <aside class="sidebar">
    <h3>Menú Estudiante</h3>
    <ul>
      <li>
        <button [routerLink]="['/dashboard-estudiante']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
          <span class="material-icons" style="vertical-align: middle;">person</span>
          <span class="sidebar-text">Inicio</span>
        </button>
      </li>
      <li>
        <button [routerLink]="['/dashboard-estudiante/unidades']" routerLinkActive="active">
          <span class="material-icons" style="vertical-align: middle;">view_module</span>
          <span class="sidebar-text">Unidades</span>
        </button>
      </li>
      <li>
        <button [routerLink]="['/dashboard-mis-cursos']" routerLinkActive="active">
          <span class="material-icons" style="vertical-align: middle;">menu_book</span>
          <span class="sidebar-text">Mis Cursos</span>
        </button>
      </li>
      <li>
        <button [routerLink]="['/dashboard-mis-clases-estudiante']" routerLinkActive="active">
          <span class="material-icons" style="vertical-align: middle;">class</span>
          <span class="sidebar-text">Mis Clases</span>
        </button>
      </li>
      <li>
        <button [routerLink]="['/dashboard-estudiante/analisis-estudiante']" routerLinkActive="active">
          <span class="material-icons" style="vertical-align: middle;">insights</span>
          <span class="sidebar-text">Análisis estudiante</span>
        </button>
      </li>
    </ul>
  </aside>
  <main class="main-content">
    <div class="dashboard-estudiante-layout">
      <!-- Formulario de perfil SOLO en inicio -->
      <ng-container *ngIf="getRouterUrl() === '/dashboard-estudiante'">
        <form *ngIf="perfil" (ngSubmit)="onSubmit()" class="perfil-form-freepik">
          <div class="perfil-form-fields">
            <h2>Información Personal</h2>
            <div class="perfil-form-grid-freepik">
              <div class="form-group">
                <label for="email">Email</label>
                <input id="email" type="email" [(ngModel)]="perfil.email" name="email" placeholder="tu@email.com" />
              </div>
              <div class="form-group">
                <label for="numero_identificacion">Número de Identificación</label>
                <input id="numero_identificacion" type="text" [(ngModel)]="perfil.numero_identificacion" name="numero_identificacion" placeholder="123456789" />
              </div>
              <div class="form-group">
                <label for="ciudad">Ciudad</label>
                <input id="ciudad" type="text" [(ngModel)]="perfil.ciudad" name="ciudad" placeholder="Tu ciudad" />
              </div>
              <div class="form-group">
                <label for="ano_nacimiento">Año de Nacimiento</label>
                <input id="ano_nacimiento" type="number" [(ngModel)]="perfil.ano_nacimiento" name="ano_nacimiento" placeholder="1990" min="1900" max="2010" />
              </div>
              <div class="form-group">
                <label for="direccion">Dirección</label>
                <input id="direccion" type="text" [(ngModel)]="perfil.direccion" name="direccion" placeholder="Tu dirección completa" />
              </div>
              <div class="form-group">
                <label for="telefono">Teléfono</label>
                <input id="telefono" type="tel" [(ngModel)]="perfil.telefono" name="telefono" placeholder="+57 300 123 4567" />
              </div>
              <div class="form-group">
                <label for="profile_image_url">URL de Imagen de Perfil</label>
                <input id="profile_image_url" type="url" [(ngModel)]="perfil.profile_image_url" name="profile_image_url" (input)="onImagenInputChange()" placeholder="https://ejemplo.com/tu-foto.jpg" />
              </div>
            </div>
            <button type="submit" class="btn-guardar-modern">Guardar cambios</button>
            <div *ngIf="mensajeExito" class="exito">{{mensajeExito}}</div>
          </div>
          <div class="perfil-foto-freepik">
            <div class="perfil-foto-oval">
              <img *ngIf="perfil.profile_image_url" [src]="perfil.profile_image_url" alt="Foto de perfil" (error)="onImagenError()" />
              <span *ngIf="imagenInvalida" class="foto-error">No se pudo cargar la imagen</span>
            </div>
            <div class="perfil-nombre-modern">
              <h3>{{ perfil.username }}</h3>
              <span class="perfil-rol">Estudiante</span>
            </div>
          </div>
        </form>
      </ng-container>
      <router-outlet></router-outlet>
    </div>
  </main>
</div>